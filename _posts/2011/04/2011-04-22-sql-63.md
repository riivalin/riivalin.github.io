---
layout: post
title: "[SQL] 取得前N筆資料 (Top、Top * Percent)"
date: 2011-04-22 05:32:00 +0800
categories: [Notes,SQL]
tags: [top]
---

- TOP：常數值
- TOP * PERCENT ：指定百分比

```sql
TOP (expression) [PERCENT]  
    [ WITH TIES ]  
```

## Top
取得前 N 筆資料

```sql
--以販賣單價排序商品清單(降幕)，並取得前5筆
select top 5 * from 商品清單
order by 販賣單價 desc
```

執行結果：
```
商品ID	商品名稱	群組名稱	進貨單價	販賣單價
2	筆記型電腦	電腦主機	299000	270000
1	桌上型電腦	電腦主機	130000	180000
5	15吋液晶螢幕	周邊設備	130000	120000
4	19吋螢幕	周邊設備	104000	95000
6	數位相機	周邊設備	50000	70000
```

## Top * Percent

取得前 N% 筆資料

```sql
--以販賣單價排序商品清單(降幕)，並取得前20%筆資料
select top 20 percent * from 商品清單
order by 販賣單價 desc
```

執行結果：

```
商品ID	商品名稱	群組名稱	進貨單價	販賣單價
2	筆記型電腦	電腦主機	299000	270000
1	桌上型電腦	電腦主機	130000	180000
5	15吋液晶螢幕	周邊設備	130000	120000
```

[MSDN - TOP (Transact-SQL)](https://learn.microsoft.com/zh-tw/sql/t-sql/queries/top-transact-sql?view=sql-server-ver16)
---
layout: post
title: "[SQL] 指定搜尋條件[LIKE(%、_)、特殊字元(Escape)、日期(Between And)、複數條件(AND、OR)]"
date: 2011-04-01 05:58:00 +0800
categories: [Notes,SQL]
tags: [like]
---

# 符合條件 LIKE(%、_)

```sql
--取得商品名稱含有「電腦」的商品名稱
select [商品名稱] from [dbo].[商品清單] where [商品名稱] like '%電腦%'

--取得商品名稱以「電腦」開頭的商品名稱
select [商品名稱] from [dbo].[商品清單] where [商品名稱] like '電腦%'

--取得商品名稱以「電腦」結尾的商品名稱
select [商品名稱] from [dbo].[商品清單] where [商品名稱] like '%電腦'
```

- 百分比`%` 是指`0`個字元以上的任意字串與條件一致(`NULL`除外)。
- 底線`_` 是指`1`個任意字元與條件一致。 


# 含有特殊字元(Escape轉譯)

```sql
--取得商品名稱中含有「_」的商品名稱
select [商品名稱] from [dbo].[商品清單] where [商品名稱] like '%\_%' escape '\'
```

如果想要搜尋的資料條件含有底線「`_`」或百分號「`%`」等特殊字元時，要讓底線被解釋為字元時，就要使用到`ESCAPE`。      

如果依然使用`where 商品名稱 like '%_%'`，那麼底線將被解釋成「1個字元的任意字元」，而無法得到想要的搜尋結果。

# 日期 Between And

```sql
--取得四月份的販賣資料
select * from [dbo].[販賣資料]
where [處理日] between '2006-04-01' and '2006-04-30'
```

`between and`不僅可以用在日期上，也可以用在數值上。



# 指定複數條件(AND、OR)

```sql
--取得群組名稱為「周邊設備」或「網路設備」，且進貨單價為$100000以下的商品名稱
select [商品名稱] from [dbo].[商品清單]
where ([群組名稱] = '周邊設備' or  [群組名稱] = '網路設備') and [進貨單價] <= 100000
```
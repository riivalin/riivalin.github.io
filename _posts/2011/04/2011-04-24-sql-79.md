---
layout: post
title: "[SQL] Stored Procedure 預存程序的參數"
date: 2011-04-24 05:29:00 +0800
categories: [Notes,SQL]
tags: [stored procedure,sp]
---

預存程序的參數有：
- 輸入參數：預設值以`=`來指定值，例如：`@id = 1`。
- 輸出參數：要加上 `output`，例如：`@count output`。(`output`可以簡寫為`out`)

執行預存程序，輸出參數也要加上`output`。


## 範例
製作統計所指定商品ID的販賣數量的預存程序        
取得的結果要儲存到參數中      
當未傳入商品ID時，預設商品ID=1來處理      

```sql
--製作統計所指定商品ID的販賣數量的預存程序
--取得的結果要儲存到參數中
--當未傳入商品ID時，預設商品ID=1來處理
create proc uspGetCount
    --定義參數
	@id int = 1, --輸入參數
	@count int output --輸出參數(要加output)
as
begin
    --處理內容(SQL語句)
	select @count = sum(數量) 
	from 販賣資料 
	where 商品ID = @id
end
```

## 執行預存程序
### 傳入ID

```sql
declare @c int --宣告變數
exec uspGetCount 10, @c output --執行sp (輸出參數要加上output)
select @c --顯示結果
```

### 沒有傳入ID
沒有傳入商品ID，會在 `@id = 1`的情況下運作

```sql
declare @c int --宣告變數
exec uspGetCount @count = @c output --執行sp (省略引數@id，輸出參數要加上output)
select @c --顯示結果
```
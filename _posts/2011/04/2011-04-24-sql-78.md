---
layout: post
title: "[SQL] Stored Procedure 預存程序的執行方法"
date: 2011-04-24 05:19:00 +0800
categories: [Notes,SQL]
tags: [stored procedure,sp]
---

[[SQL] Stored Procedure 預存程序的建立](https://riivalin.github.io/posts/2011/04/sql-77/)

執行預存程序要使用`execute`語法(可以簡寫為`exec`)，在`execute`後面寫要執行的預存程序的名稱。        

要指定引數時，有兩種方式：
1. 以位置來指定
2. 以名稱來指定

```sql
exec uspTest 1, @result output --以位置來指定
exec uspTest @result output, @id = 1 --以名稱來指定
```

以「位置」來指定引數時，引數的指定順序要與預存程序中定義的順序相同才行。        
以「名稱」來指定引數就不需要按照順序。


> 引數(Argument) 是用於呼叫函式。       
> 參數(Parameter) 是方法簽章(方法的宣告)。

## 語法

```sql
exec 預存程序名稱 @變數1 = '值1', @變數2 = '值2'
```

## 以「位置」來指定引數

數的指定順序要與預存程序中定義的順序相同才行。

```sql
exec uspTest 1, @result output
```

```sql
declare @result int --宣告變數
exec uspTest 1, @result output --執行sp。輸出參數要加上output
select @result --顯示結果
```
> `output`可以簡寫為`out`

## 以「名稱」來指定引數

位置順序可以不同

```sql
exec uspGetSum @id = 1, @sum = @result output
exec uspGetSum @sum = @result output, @id = 1
```

```sql
declare @result int --宣告變數
exec uspGetSum @id = 1, @sum = @result output --執行sp。輸出參數要加上output
select @result --顯示結果
```

[MSDN - 執行預存程序](https://learn.microsoft.com/zh-tw/sql/relational-databases/stored-procedures/execute-a-stored-procedure?view=sql-server-ver15)        
[[SQL] Stored Procedure 預存程序的建立與刪除](https://riivalin.github.io/posts/2011/04/sql-58/)		
[[SQL] Stored Procedure 預存程序的建立](https://riivalin.github.io/posts/2011/04/sql-77/)		